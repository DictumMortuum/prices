(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{241:function(e,t,a){e.exports=a.p+"static/media/cartoff.dd87c6d4.svg"},242:function(e){e.exports={name:"prices",version:"0.2.3",private:!0,homepage:"https://prices.dictummortuum.com",dependencies:{"@auth0/auth0-react":"^1.10.1","@babel/runtime":"7.0.0-beta.55","@material-ui/core":"4.12.3","@material-ui/data-grid":"^4.0.0-alpha.37","@material-ui/icons":"^4.11.2","@material-ui/lab":"^4.0.0-alpha.60","@reduxjs/toolkit":"^1.7.1","ansi-regex":"^5.0.1",braces:"^2.3.1",browserslist:"^4.16.5",chartist:"^0.10.1",classnames:"^2.2.6",fflate:"^0.7.3","fuse.js":"^6.5.3","glob-parent":"^5.1.2",immer:"^9.0.6","incremental-average":"^1.1.0","js-combinatorics":"^0.5.4","json-schema":"^0.4.0","material-ui-image":"^3.2.0",merge:"^2.1.1","node-notifier":"^8.0.1","nth-check":"^2.0.1","p-retry":"^5.1.0","prop-types":"^15.6.0","ra-data-fakerest":"^4.2.0",react:"^17.0.2","react-admin":"^4.2.0","react-chartist":"^0.14.4","react-dev-utils":"^11.0.4","react-dom":"^17.0.2","react-icons":"^4.2.0","react-player":"^2.10.1","react-redux":"^7.2.4","react-router":"^5.2.0","react-router-dom":"^5.2.0","react-scripts":"^2.0.0","react-share":"^4.4.0","react-spinners":"^0.11.0","react-xml-parser":"^1.1.8",recharts:"^2.0.9",redux:"^4.1.0","redux-devtools-extension":"^2.13.9",reselect:"^4.0.0","serialize-javascript":"^3.1.0",sockjs:"^0.3.20",tar:"^4.4.18",tmpl:"^1.0.5","ts-trueskill":"^3.2.2","url-parse":"^1.5.2","use-query-params":"^1.2.3","yargs-parser":"^13.1.2"},scripts:{start:"react-scripts start",build:"react-scripts build",test:"react-scripts test",eject:"react-scripts eject",predeploy:"yarn build",deploy:"gh-pages -d build",stats:"curl 'localhost:1234/rest/v1/play?_resource=stats' | jq  > ./src/standings/plays.json; curl 'localhost:1234/rest/v1/trueskill' > ./src/standings/ratings.json; curl 'localhost:1234/rest/v1/trueskill/overall' > ./src/standings/overall.json",prices:"curl 'localhost:1234/rest/v1/price?_resource=history'"},eslintConfig:{extends:"react-app"},browserslist:[">0.2%","not ie <= 11","not op_mini all"],devDependencies:{"@babel/helper-call-delegate":"^7.8.7","gh-pages":"^3.1.0"}}},282:function(e,t,a){e.exports=a(450)},287:function(e,t,a){},450:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),c=a(23),i=a.n(c),o=(a(287),a(78)),u=a(30),s=a(264),l=a(531),m=a(43),d=a(14),f=a(36),p=a(28),b=a(12),h=a(509),E=a(269),g=a(494),_=a(495),v=a(496),j=a(492),O=function(e){var t=e.srcs,a=Object(r.useState)(0),c=Object(b.a)(a,2),i=c[0],o=c[1],u=void 0===t[i]?"https://via.placeholder.com/250":t[i];return Object(r.useEffect)(function(){var e=new Image;e.onerror=function(){o(i+1)},e.onload=function(){e.complete&&e.naturalWidth<100&&e.naturalHeight<100&&o(i+1)},e.src=t[i]},[t]),n.a.createElement(j.a,{style:{paddingTop:"75%"},image:u})},y=a(266),k=n.a.forwardRef(function(e,t){return function(e){var t=e.to,a=e.children,r=(e.component,Object(y.a)(e,["to","children","component"])),c=Object(u.g)().search,i=new URLSearchParams(c);i.delete("page");var s="".concat(t,"?").concat(i.toString());return n.a.createElement(o.b,Object.assign({},r,{to:s}),a)}(Object(p.a)({},e,{ref:t}))}),w="https://raw.githubusercontent.com/DictumMortuum/json-api/master",S=function(e){if(202===e.status)throw new Error("impersonating an error, as we have to retry, since the request is queued on the backend now");return e},x=function(e){console.log("Attempt ".concat(e.attemptNumber," failed. There are ").concat(e.retriesLeft," retries left."))},R=function(e){var t={};return e.children.map(function(e){var a=e.name,r=e.attributes,n=e.value;return t[a]=""!==n?n:r,a}),Object(p.a)({id:parseInt(e.attributes.objectid)},t)},T=function(e){return e.children.map(R)},I={boardgame_id:"",boardgame_name:"",images:[]},C=function(e){var t=Object(r.useState)(I),a=Object(b.a)(t,2),n=a[0],c=a[1];return Object(r.useEffect)(function(){var t=!0;return function(e){return fetch(w+"/rest/v1/boardgames/"+e+"/boardgame.json").then(function(e){return e.json()})}(e).then(function(e){t&&c(e)}),function(){t=!1}},[e]),n},W=a(237),N=a.n(W),A=a(497),D=a(498),L=a(15),F=Object(g.a)(function(e){return{card_header:{minHeight:120}}}),H=function(e){var t=e.id,a=e.boardgame_id,r=e.rank,c=e.items,i=Object(d.b)(),o=F(),u=C(a),s=u.images,l=u.boardgame_name,m=c.sort(function(e,t){return e.price-t.price}),p=m.length,h=Object(L.g)("bgg_id",Object(L.h)(L.c,[])),g=Object(b.a)(h,2),j=g[0],y=g[1],w=void 0,S=void 0;return p>=1&&(w=m[0]),p>=2&&w.price!==m[p-1].price&&(S=m[p-1]),n.a.createElement(_.a,{key:t,square:!0,elevation:3},n.a.createElement(k,{to:"/item/"+a},n.a.createElement(O,{srcs:["https://raw.githubusercontent.com/DictumMortuum/json-api/master/rest/v1/boardgames/".concat(a,"/image.avif")].concat(Object(f.a)(s))})),n.a.createElement(v.a,{className:o.card_header},r<999999&&n.a.createElement(E.a,{variant:"subtitle1",color:"textSecondary"},"BGG Rank ",r),n.a.createElement(E.a,{variant:"subtitle1",color:"textSecondary"},w&&"\u20ac"+w.price," ",S&&"- \u20ac"+S.price),n.a.createElement(E.a,{variant:"subtitle1"},l)),n.a.createElement(A.a,null,n.a.createElement(D.a,{onClick:function(){return function(e,t){return function(a,r){e({type:"ADD_TO_CART",cart:a}),r.includes(a)?t(r.filter(function(e){return e!==a})):t([].concat(Object(f.a)(r),[a]))}}(i,y)(a,j)}},n.a.createElement(N.a,null))))},P=a(512),M=a(508),U=a(503),z=a(532),B=a(539),G=a(499),q=a(542),K=function(){var e=Object(d.c)(function(e){return e.pricesReducer}).stock,t=Object(d.b)(),a=Object(L.g)("stock",L.b),r=Object(b.a)(a,2)[1];return n.a.createElement(G.a,{variant:"outlined",fullWidth:!0},n.a.createElement(B.a,{htmlFor:"stock-select-label"},"Stock"),n.a.createElement(z.a,{labelId:"stock-select-label",id:"stock-select",value:e,onChange:function(e){t({type:"SET_STOCK",stock:e.target.value}),r(e.target.value)}},["In stock","Preorder","Out of stock"].map(function(e,t){return n.a.createElement(q.a,{key:e,value:t},e)}),n.a.createElement(q.a,{key:-1,value:-1},"Show all")))},V=a(500),J=function(e){var t=e.stores,a=e.current_stores,r=Object(d.c)(function(e){return e.pricesReducer}).store,c=Object(d.b)(),i=Object(L.g)("store",L.c),o=Object(b.a)(i,2)[1];return n.a.createElement(G.a,{variant:"outlined",fullWidth:!0},n.a.createElement(B.a,{htmlFor:"store-select-label"},"Store"),n.a.createElement(z.a,{labelId:"store-select-label",id:"store-select",value:r,multiple:!0,onChange:function(e){var t=function(e){var t=e.slice(-1);return-1===Object(b.a)(t,1)[0]?[-1]:Object(f.a)(new Set(e.filter(function(e){return-1!==e})))}(e.target.value);c({type:"SET_STORE",store:t}),o(t)}},n.a.createElement(q.a,{key:-1,value:-1},"All stores"),n.a.createElement(V.a,{style:{background:"white"}},"With Stock"),a.map(function(e){return n.a.createElement(q.a,{key:e.id,value:e.id},e.name)}),n.a.createElement(V.a,{style:{background:"white"}},"Rest"),t.map(function(e){return n.a.createElement(q.a,{key:e.id,value:e.id},e.name)})))},Y=a(537),X=Object(g.a)(function(e){return{root:{color:"#d8dee9",flexGrow:1},color:{color:"#d8dee9",textDecoration:"none"}}}),Q=function(){var e=X(),t=Object(u.g)().pathname.split("/").slice(2).filter(function(e){return"item"!==e}).filter(function(e){return""!==e});return n.a.createElement(Y.a,{className:e.root,separator:"/","aria-label":"breadcrumb"},n.a.createElement(k,{className:e.color,to:"/"},n.a.createElement(E.a,{variant:"h5"},"Prices")),t.map(function(t){return n.a.createElement(k,{key:t,className:e.color,to:"/item/"+t},n.a.createElement(E.a,{variant:"h5"},t))}))},Z=a(511),$=a(241),ee=a.n($),te=a(268),ae=a(45),re=a(540),ne=a(22),ce=a.n(ne),ie=a(33),oe=a(151),ue=a.n(oe),se=a(501),le=function(){var e=Object(d.b)(),t=Object(d.c)(function(e){return e.pricesReducer}).search_term,a=Object(r.useState)(!1),c=Object(b.a)(a,2),i=c[0],o=c[1],s=Object(u.f)(),l=Object(r.useRef)(!0);Object(r.useEffect)(function(){return function(){l.current=!1}},[]);var m=Object(r.useCallback)(Object(ie.a)(ce.a.mark(function t(){return ce.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!i){t.next=2;break}return t.abrupt("return");case 2:o(!0),e({type:"EXECUTE_SEARCH"}),s.push("/search"),l.current&&o(!1);case 6:case"end":return t.stop()}},t)})),[t,e]);return n.a.createElement(se.a,{position:"end"},n.a.createElement(D.a,{type:"submit",disabled:i,onClick:m,"aria-label":"search"},n.a.createElement(ue.a,null)))},me=Object(g.a)(function(e){return{input:{margin:e.spacing(1)},root:Object(ae.a)({margin:e.spacing(1)},e.breakpoints.up("md"),{marginRight:e.spacing(3)})}}),de=function(e){return function(t){return e({type:"SET_SEARCH_TERM",payload:t.target.value})}},fe=function(e){var t=Object(d.b)(),a=me();return n.a.createElement(te.a,{component:"form",onSubmit:function(e){e.preventDefault()}},n.a.createElement(re.a,{placeholder:" Search...",className:a.input,fullWidth:!0,inputProps:{"aria-label":"search"},onChange:de(t),endAdornment:n.a.createElement(le,null)}))},pe=a(510),be=a(513),he=a(242),Ee=a(533),ge=a(502),_e=a(543),ve=a(504),je=a(505),Oe=a(506),ye=(a(507),a(152)),ke=function(){var e=Object(d.b)(),t=Object(d.c)(function(e){return e.pricesReducer.user}).saved,a=Object(ye.b)(),n=a.isAuthenticated,c=a.user,i=a.loginWithRedirect,o=a.logout;return Object(r.useEffect)(function(){var a;n&&!t&&(a=c,fetch("".concat("https://szb34l.deta.dev","/user"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}).then(function(e){return e.json()})).then(function(t){return e({type:"SET_USER",payload:{isAuthenticated:n,details:t}})})},[e,n,t,c]),{isAuthenticated:n,user:c,loginWithRedirect:i,logout:o}},we=Object(g.a)(function(e){return{root:{background:"#d8dee9",fontFamily:"sans"},appbar:{marginBottom:e.spacing(4)},bottomBar:{top:"auto",bottom:0},content:{minHeight:"90vh",padding:10},margin:{color:"white"},pagination:{padding:e.spacing(1)}}}),Se=function(e,t){return Math.ceil(e.length/t)},xe=function(e){return n.a.createElement(te.a,Object.assign({variant:"outlined",square:!0},e))},Re=function(e){var t=e.loginWithRedirect;return n.a.createElement(ge.a,{onClick:function(){return t()},color:"inherit"},"Login")},Te=function(e){var t=e.user,a=e.logout,r=t.picture,c=t.name;return n.a.createElement(D.a,{onClick:function(){return a({returnTo:window.location.origin})}},n.a.createElement(_e.a,{alt:c,src:r}))},Ie=function(e){var t=e.cart_results;return n.a.createElement(D.a,null,n.a.createElement(U.a,{badgeContent:t.length,color:"secondary",max:99999,style:{color:"white"},component:k,to:"/cart"},n.a.createElement(ve.a,null)))},Ce=function(){return n.a.createElement(D.a,{style:{color:"white"},component:k,to:"/wishlist"},n.a.createElement(je.a,null))},We=function(){return n.a.createElement(D.a,{style:{color:"white"},component:k,to:"/search"},n.a.createElement(Oe.a,null))},Ne=function(e){var t=e.matches,a=e.breadcrumbs,c=e.isAuthenticated,i=e.cart_results,o=e.loginWithRedirect,u=e.logout,s=e.user;return n.a.createElement(M.a,null,a&&n.a.createElement(Q,null),t&&n.a.createElement(r.Fragment,null,n.a.createElement(fe,null),n.a.createElement(We,null),n.a.createElement(Ce,null),!1,n.a.createElement(Ie,{cart_results:i}),c?n.a.createElement(Te,{logout:u,user:s}):n.a.createElement(Re,{loginWithRedirect:o})))},Ae=function(e){return n.a.createElement(h.a,{container:!0,alignContent:"center",alignItems:"center",direction:"column"},n.a.createElement(h.a,{item:!0,xs:12},e.spinner?n.a.createElement(pe.a,null):n.a.createElement(E.a,{variant:"body1",color:"inherit"},n.a.createElement("img",{style:{height:300},alt:"",src:ee.a}))))},De=function(e){var t=e.stores,a=e.additional_controls,r=e.stock_filtered,c=Object(f.a)(new Set(r.map(function(e){return e.store_id}))),i=t.filter(function(e){return c.includes(e.id)}),o=t.filter(function(e){return!c.includes(e.id)});return n.a.createElement(h.a,{container:!0,spacing:2},n.a.createElement(h.a,{item:!0,xs:12},n.a.createElement(J,{stores:o,current_stores:i})),n.a.createElement(h.a,{item:!0,xs:12},n.a.createElement(K,null)),null!==a&&a)},Le=function(e){var t=e.child_data,a=e.page_size,r=e.paging,c=e.pre_component,i=e.store_filtered,o=e.component,u=e.spinner,s=Object(L.g)("page",Object(L.h)(L.b,1)),l=Object(b.a)(s,2),m=l[0],d=l[1],f=function(e,t,a,r){return!0===r?e.slice((a-1)*t,a*t):e}(t,a,m,r);return n.a.createElement(h.a,{container:!0,spacing:2},t.length>a&&r&&n.a.createElement(h.a,{item:!0,xs:12},n.a.createElement(Ee.a,{variant:"outlined",shape:"rounded",count:Se(t,a),page:m,onChange:function(e,t){return d(t,"pushIn")}})),void 0!==c&&c,i.length>0?o(f):n.a.createElement(Ae,{spinner:u}),t.length>a&&r&&n.a.createElement(h.a,{item:!0,xs:12},n.a.createElement(Ee.a,{variant:"outlined",shape:"rounded",count:Se(t,a),page:m,onChange:function(e,t){return d(t,"pushIn")}})))},Fe=function(e){var t=we(),a=Object(Z.a)(function(e){return e.breakpoints.up("md")}),c=Object(d.c)(function(e){return e.pricesReducer}),i=c.stores,o=c.cart_results,u=c.spinner,s=c.date,l=e.store_filtered,m=e.stock_filtered,f=e.child_data,p=e.component,g=e.pre_component,_=e.additional_controls,v=e.paging,j=void 0===v||v,O=e.page_size||12,y=Object(L.g)("page",Object(L.h)(L.b,1)),k=Object(b.a)(y,1)[0],w=ke(),S=w.loginWithRedirect,x=w.logout,R=w.isAuthenticated,T=w.user;return Object(r.useEffect)(function(){window.scrollTo(0,0)},[k]),n.a.createElement(h.a,{container:!0,className:t.root,alignContent:"center",alignItems:"center"},n.a.createElement(P.a,{position:"static",className:t.appbar},n.a.createElement(Ne,{user:T,breadcrumbs:!0,matches:a,isAuthenticated:R,cart_results:o,loginWithRedirect:S,logout:x})),n.a.createElement(be.a,{maxWidth:"xl"},n.a.createElement(h.a,{container:!0,spacing:4,component:xe,className:t.content},n.a.createElement(h.a,{item:!0,md:2,xs:12,component:"div"},n.a.createElement(De,{stock_filtered:m,stores:i,additional_controls:_})),n.a.createElement(h.a,{item:!0,md:10,xs:12,component:"div"},n.a.createElement(Le,{child_data:f,page_size:O,paging:j,pre_component:g,store_filtered:l,spinner:u,component:p})))),!a&&n.a.createElement(P.a,{position:"fixed",className:t.bottomBar},n.a.createElement(Ne,{user:T,breadcrumbs:!1,matches:!a,isAuthenticated:R,cart_results:o,loginWithRedirect:S,logout:x})),n.a.createElement(h.a,{item:!0,xs:12},n.a.createElement(M.a,null,n.a.createElement(E.a,{variant:"body1",color:"inherit"},"\xa9 2022 Dimitris Raviolos - ",he.version," - Last update: ",new Date(s).toLocaleDateString("el-GR")))))},He=function(e){return function(t){return!!e.includes(-1)||e.includes(t.store_id)}},Pe=function(e){return function(t){return t.stock===e||-1===e}},Me=function(e){var t=Object(d.c)(function(e){return e.pricesReducer}),a=t.store,r=t.stock,n=t.prices,c=void 0!==e?e(n):n,i=c.filter(Pe(r)),o=i.filter(He(a));return{page_filtered:c,stock_filtered:i,store_filtered:o}},Ue=function(e){var t=[];return e.map(function(e){return void 0===t[e.boardgame_id]&&(t[e.boardgame_id]=Object(p.a)({},e,{items:[]}),void 0===t[e.boardgame_id].rank&&(t[e.boardgame_id].rank=999999)),t[e.boardgame_id].items.push(e),e}),t.filter(function(e){return e.items.length>0}).sort(function(e,t){return e.rank-t.rank})},ze=function(){var e=Me(),t=e.store_filtered,a=e.stock_filtered,r=Ue(t);return n.a.createElement(Fe,{child_data:r,stock_filtered:a,store_filtered:t,paging:!0,page_name:"/",component:function(e){return e.map(function(e){return n.a.createElement(h.a,{key:e.id,item:!0,xs:12,md:6,lg:3},n.a.createElement(H,e))})}})},Be=a(11),Ge=a.n(Be),qe=a(514),Ke=a(515),Ve=a(516),Je=a(517),Ye=a(518),Xe=a(519),Qe=a(520),Ze=a(521),$e=a(522),et=a(523),tt=Object(g.a)(function(e){return{media:{height:0,paddingTop:"75%"},card_header:{minHeight:110},out_of_stock:{opacity:.5}}}),at=function(e){var t=new URL(e);return t.searchParams.append("utm_source","dictummortuum"),t.searchParams.append("utm_medium","dictummortuum"),t.searchParams.append("utm_campaign","dictummortuum"),t.toString()},rt=function(e){var t=e.boardgame,a=t.store_thumb,r=t.url,c=t.thumb,i=t.boardgame_id,o=t.stock,u=e.self_ref,s=tt();return u?n.a.createElement(k,{to:"/item/"+i+"?stock="+o},n.a.createElement(j.a,{className:s.media,image:""===a?c:a})):n.a.createElement("a",{href:at(r),target:"_blank",rel:"noopener noreferrer"},n.a.createElement(j.a,{className:s.media,image:""===a?c:a}))},nt=function(e){var t=tt(),a=Object(d.c)(function(e){return e.pricesReducer}).stores,r=e.boardgame,c=r.url,i=r.name,o=r.store_id,u=r.price,s=r.stock,l=window.location.href;return n.a.createElement(_.a,{className:Ge()(Object(ae.a)({},t.out_of_stock,2===s))},c&&n.a.createElement(rt,e),n.a.createElement(A.a,null,n.a.createElement(D.a,{component:"div"},n.a.createElement(qe.a,{style:{height:24},url:l},n.a.createElement(Ke.a,{size:24,round:!0}))),n.a.createElement(D.a,{component:"div"},n.a.createElement(Ve.a,{style:{height:24},url:l},n.a.createElement(Je.a,{size:24,round:!0}))),n.a.createElement(D.a,{component:"div"},n.a.createElement(Ye.a,{style:{height:24},url:l},n.a.createElement(Xe.a,{size:24,round:!0}))),n.a.createElement(D.a,{component:"div"},n.a.createElement(Qe.a,{style:{height:24},url:l},n.a.createElement(Ze.a,{size:24,round:!0}))),n.a.createElement(D.a,{component:"div"},n.a.createElement($e.a,{style:{height:24},url:l},n.a.createElement(et.a,{size:24,round:!0})))),n.a.createElement(v.a,{className:t.card_header},n.a.createElement(E.a,{variant:"subtitle1",color:"textSecondary"},a.filter(function(e){return e.id===o}).map(function(e){return e.name})),n.a.createElement(E.a,{variant:"subtitle1",color:"textSecondary"},"\u20ac",u),n.a.createElement(E.a,{variant:"subtitle1"},i)))},ct=a(524),it=a(535),ot=a(528),ut=a(259),st=a(260),lt=a(133),mt=a(258),dt=a(256),ft=Object(g.a)(function(e){return{root:{padding:e.spacing(4)},label:{marginBottom:e.spacing(1)}}}),pt=function(e){for(var t=e[0].price,a=e[0].price,r=e[0].price,n=1;n<e.length;n++)e[n].price>t&&(t=e[n].price),e[n].price<a&&(a=e[n].price),r+=e[n].price;return{max:parseFloat(t.toFixed(2)),min:parseFloat(a.toFixed(2)),avg:parseFloat((r/e.length).toFixed(2))}},bt=function(e){var t=new Date(e);return t.getDate()+"/"+(t.getMonth()+1)},ht=function(e){var t=new Date(e);return t.getDate()+"/"+(t.getMonth()+1)+"/"+t.getFullYear()},Et=function(e){var t,a=ft(),r=e.history,c=Object(d.c)(function(e){return e.pricesReducer}),i=c.store,o=c.stock,u=function(e){var t={};e.map(function(e){return void 0===t[e.cr_date]&&(t[e.cr_date]=[]),t[e.cr_date].push(e),e});var a=[];for(var r in t){var n=new Date(r),c=pt(t[r]),i=c.avg,o=c.min,u=c.max;a.push({avg:i,range:[o,u],cr_date:n.valueOf()})}return a}(r.filter(Pe(o)).filter(He(i))).sort(function(e,t){return t.cr_date-e.cr_date});return n.a.createElement(te.a,{className:a.root},n.a.createElement(E.a,{variant:"body1",color:"inherit",className:a.label},"Price history"),n.a.createElement(ct.a,{width:"100%",height:200},n.a.createElement(it.a,{data:u},n.a.createElement(ot.a,{strokeDasharray:"5 5"}),n.a.createElement(ut.a,{dataKey:"cr_date",scale:"time",type:"number",domain:(t=u,0===t.length?[]:[t[0].cr_date-432e5,t[t.length-1].cr_date+432e5]),tickFormatter:bt}),n.a.createElement(st.a,{domain:["auto","auto"],type:"number"}),n.a.createElement(lt.a,{labelFormatter:ht}),n.a.createElement(mt.a,{type:"monotone",dataKey:"range",fillOpacity:.3,fill:"#5e81ac"}),n.a.createElement(dt.a,{type:"monotone",dataKey:"avg",stroke:"#bf616a",strokeWidth:3,activeDot:{r:8}}))))},gt=function(e){var t=Object(r.useState)([]),a=Object(b.a)(t,2),n=a[0],c=a[1];return Object(r.useEffect)(function(){(function(e){return fetch(w+"/rest/v1/boardgames/"+e+"/prices.json").then(function(e){return e.json()})})(e).then(function(e){return c(e)})},[e]),n},_t=function(e){var t=Object(r.useState)([]),a=Object(b.a)(t,2),n=a[0],c=a[1];return Object(r.useEffect)(function(){var t=!0;return function(e){return fetch(w+"/rest/v1/boardgames/"+e+"/history.json").then(function(e){return e.json()})}(e).then(function(e){t&&c(e)}),function(){t=!1}},[e]),n},vt=function(){var e=Object(u.g)().pathname;return parseInt(e.split("/")[2])},jt=function(){var e=vt(),t=Me(function(e){return function(t){return t.filter(function(t){return t.boardgame_id===e}).sort(function(e,t){return e.price-t.price})}}(e)),a=t.stock_filtered,r=t.store_filtered,c=_t(e),i=gt(e),o=r.map(function(e){return e.id});return n.a.createElement(Fe,{child_data:i.filter(function(e){return o.includes(e.id)}),stock_filtered:a,store_filtered:r,paging:!1,pre_component:n.a.createElement(h.a,{item:!0,xs:12},n.a.createElement(Et,{history:c})),component:function(e){return e.map(function(e){return n.a.createElement(h.a,{key:e.id,item:!0,xs:12,md:6,lg:3},n.a.createElement(nt,{boardgame:e}))})}})},Ot=function(){return n.a.createElement(h.a,{container:!0,alignContent:"center",alignItems:"center",direction:"column"},n.a.createElement(h.a,{item:!0,xs:12},n.a.createElement(pe.a,null)))},yt=function(e){var t=e.id,a=e.boardgame_id,r=e.wishlist,c=e.preview,i=r.filter(function(e){return e.id===a}),o=Object(b.a)(i,1)[0].thumbnail;return n.a.createElement(_.a,{key:t,square:!0,elevation:3},n.a.createElement(k,{to:"/item/"+a},n.a.createElement(j.a,{style:{paddingTop:"75%"},image:void 0===o?c:o})))},kt=a(155),wt=a.n(kt),St=a(158),xt=function(e){return fetch("".concat("https://api.geekdo.com/xmlapi2","/collection?username=").concat(encodeURIComponent(e),"&wishlist=1")).then(S).then(function(e){return e.text()}).then(function(e){var t=(new wt.a).parseFromString(e);return T(t)})},Rt=function(e,t){return Object(St.a)(Object(ie.a)(ce.a.mark(function t(){return ce.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",xt(e));case 1:case"end":return t.stop()}},t)})),{onFailedAttempt:x,retries:t})},Tt=a(541),It=function(e){return function(t){return e({type:"SET_WISHLIST_USERNAME",payload:t.target.value})}},Ct=function(e){var t=Object(d.b)(),a=Object(r.useState)(!1),c=Object(b.a)(a,2),i=c[0],o=c[1],u=Object(r.useRef)(!0),s=Object(d.c)(function(e){return e.pricesReducer}).wishlist_term,l=Object(L.g)("bgg_username",L.e),m=Object(b.a)(l,2)[1];Object(r.useEffect)(function(){return function(){u.current=!1}},[]);var f=Object(r.useCallback)(function(){var e=Object(ie.a)(ce.a.mark(function e(a){var r;return ce.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!i){e.next=2;break}return e.abrupt("return");case 2:return o(!0),t({type:"TOGGLE_SPINNER"}),e.prev=4,e.next=7,Rt(a,2);case 7:r=e.sent,e.next=13;break;case 10:e.prev=10,e.t0=e.catch(4),r=[];case 13:t({type:"SET_WISHLIST",payload:r}),m(a),t({type:"TOGGLE_SPINNER"}),u.current&&o(!1);case 17:case"end":return e.stop()}},e,null,[[4,10]])}));return function(t){return e.apply(this,arguments)}}(),[t]);return n.a.createElement(G.a,{variant:"outlined",fullWidth:!0},n.a.createElement(B.a,{htmlFor:"bgg-input"},"Bgg username"),n.a.createElement(Tt.a,{style:{paddingRight:0},id:"bgg-input",value:s,onChange:It(t),onKeyPress:function(e){"Enter"===e.key&&(e.preventDefault(),f(s))},endAdornment:n.a.createElement(se.a,{position:"end"},n.a.createElement(D.a,{disabled:i,onClick:function(e){e.preventDefault(),f(s)},"aria-label":"search"},n.a.createElement(ue.a,null)))}))},Wt=a(538),Nt=a(529),At=a(530),Dt=function(e){var t=e.onChange,a=e.wishlist_priority;return n.a.createElement(G.a,{variant:"outlined",fullWidth:!0},n.a.createElement(B.a,{id:"priority-select-label"},"Priority"),n.a.createElement(z.a,{labelId:"priority-select-label",id:"priority-select",value:a,onChange:t},n.a.createElement(q.a,{key:-1,value:-1},"All priorities"),[1,2,3,4,5].map(function(e){return n.a.createElement(q.a,{key:e,value:e},"Priority ",e)})))},Lt=function(e){var t=e.wishlist_stores_view,a=e.onChange;return n.a.createElement(G.a,{component:"fieldset"},n.a.createElement(Nt.a,null,n.a.createElement(At.a,{control:n.a.createElement(Wt.a,{checked:t,onChange:a}),label:"Stores view"})))},Ft=function(e){return e.reduce(function(e,t){return e+t.price},0).toFixed(2)},Ht=function(e){var t=[];return e.map(function(e){return void 0===t[e.store_id]&&(t[e.store_id]={store_id:e.store_id,items:[]}),t[e.store_id].items.push(e),e}),t.filter(function(e){return e.items.length>0}).sort(function(e,t){var a=t.items.length-e.items.length;return 0!==a?a:Ft(t.items)-Ft(e.items)})},Pt=function(e){var t=e.store_id,a=e.items,r=e.wishlist,c=function(e){var t=Object(d.c)(function(e){return e.pricesReducer}).stores.filter(function(t){return t.id===e});return Object(b.a)(t,1)[0]}(t),i=Ft(a);return n.a.createElement(h.a,{container:!0,spacing:1},n.a.createElement(h.a,{item:!0,xs:12},n.a.createElement(E.a,{variant:"h4"},c.name," -  \u20ac",i)),a.sort(function(e,t){return e.boardgame_id-t.boardgame_id}).map(function(e){return n.a.createElement(h.a,{key:e.id,item:!0,xs:6,md:3,lg:1},n.a.createElement(yt,Object.assign({},e,{wishlist:r})))}))},Mt=function(e){return e.map(function(e){return n.a.createElement(h.a,{key:e.id,item:!0,xs:12,md:6,lg:3},n.a.createElement(H,e))})},Ut=function(e){return function(t){return t.map(function(t){return n.a.createElement(h.a,{key:t.store_id,item:!0,xs:12},n.a.createElement(Pt,Object.assign({},t,{wishlist:e})))})}},zt=function(){var e,t=function(){var e=Object(d.c)(function(e){return e.pricesReducer}).wishlist,t=Object(L.g)("bgg_username",L.e),a=Object(b.a)(t,1)[0],n=Object(d.b)();return Object(r.useEffect)(Object(ie.a)(ce.a.mark(function e(){var t;return ce.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===a){e.next=12;break}return n({type:"SET_WISHLIST_USERNAME",payload:a}),e.prev=2,e.next=5,Rt(a,2);case 5:t=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),t=[];case 11:n({type:"SET_WISHLIST",payload:t});case 12:case"end":return e.stop()}},e,null,[[2,8]])})),[a]),e}(),a=Object(d.b)(),c=Object(d.c)(function(e){return e.pricesReducer}),i=c.wishlist_priority,o=c.wishlist_stores_view,u=c.spinner,s=t.filter(function(e){return parseInt(e.status.wishlistpriority)===i||-1===i}),l=Me(function(e){return e.filter(function(e){return s.map(function(e){return e.id}).includes(e.boardgame_id)})}),m=l.stock_filtered,f=l.store_filtered,p=Object(L.g)("stores_view",Object(L.h)(L.a,!1)),E=Object(b.a)(p,2)[1];return e=o?Ht(f):Ue(f),n.a.createElement(Fe,{child_data:e,stock_filtered:m,store_filtered:f,page_name:"/wishlist",additional_controls:n.a.createElement(n.a.Fragment,null,n.a.createElement(h.a,{item:!0,xs:12},n.a.createElement(Ct,null)),n.a.createElement(h.a,{item:!0,xs:12},n.a.createElement(Dt,{wishlist_priority:i,onChange:function(e){a({type:"SET_PRIORITY",payload:e.target.value})}})),n.a.createElement(h.a,{item:!0,xs:12},n.a.createElement(Lt,{wishlist_stores_view:o,onChange:function(e){a({type:"SET_WISHLIST_VIEW",payload:e.target.checked}),E(e.target.checked)}}))),component:function(e){return u?n.a.createElement(Ot,null):o?Ut(t)(e):Mt(e)}})},Bt=function(){var e,t=Object(d.c)(function(e){return e.pricesReducer}),a=t.cart_results,r=t.wishlist_stores_view,c=t.spinner,i=Me(function(e){return e.filter(function(e){return a.includes(e.boardgame_id)})}),o=i.stock_filtered,u=i.store_filtered,s=Object(d.b)();return e=r?Ht(u):Ue(u),n.a.createElement(Fe,{child_data:e,stock_filtered:o,store_filtered:u,page_name:"/cart",additional_controls:n.a.createElement(h.a,{item:!0,xs:12},n.a.createElement(Lt,{wishlist_stores_view:r,onChange:function(e){s({type:"SET_WISHLIST_VIEW",payload:e.target.checked})}})),component:function(e){return c?n.a.createElement(Ot,null):r?Ut(a.map(function(e){return{id:e}}))(e):Mt(e)}})},Gt=a(262),qt=function(e){var t=Object(d.c)(function(e){return e.pricesReducer}),a=t.search_term,r=t.search_enabled,n=t.search_results;if(""!==a&&r){return new Gt.a(e,{includeScore:!0,shouldSort:!0,ignoreLocation:!0,keys:["name"]}).search(a).filter(function(e){return e.score<=.6}).map(function(e){return e.item})}return n},Kt=function(){var e=Me(qt),t=e.store_filtered,a=e.stock_filtered,r=function(e){var t=[],a={};return e.map(function(e,r){return void 0!==a[e.boardgame_id]&&(r=a[e.boardgame_id]),void 0===t[r]&&(t[r]=Object(p.a)({},e,{items:[]}),a[e.boardgame_id]=r),t[r].items.push(e),e}),t.filter(function(e){return e.items.length>0})}(t);return n.a.createElement(Fe,{child_data:r,stock_filtered:a,store_filtered:t,paging:!0,page_name:"/search",pre_component:n.a.createElement(h.a,{item:!0,xs:12},n.a.createElement(fe,null)),component:function(e){return e.map(function(e){return n.a.createElement(h.a,{key:e.id,item:!0,xs:12,md:6,lg:3},n.a.createElement(H,e))})}})},Vt=Object(g.a)(function(e){return{margin:{marginBottom:e.spacing(1)},padding:{paddingLeft:e.spacing(1)},colored:{backgroundColor:"#81a1c1",color:"white"}}}),Jt=function(e){var t=Vt(),a=e.id,r=e.boardgame_id,c=e.rank,i=e.items,o=e.alternate,u=C(r).boardgame_name,s=i.sort(function(e,t){return e.price-t.price}),l=s.length,m=void 0,d=void 0;return l>=1&&(m=s[0]),l>=2&&m.price!==s[l-1].price&&(d=s[l-1]),n.a.createElement(k,{to:"/item/"+r,style:{textDecoration:"none"}},n.a.createElement(te.a,{className:Ge()(t.margin,Object(ae.a)({},t.colored,0===o))},n.a.createElement(h.a,{container:!0,spacing:2,key:a},n.a.createElement(h.a,{item:!0,xs:8},n.a.createElement(E.a,{variant:"subtitle1",className:t.padding},u)),n.a.createElement(h.a,{item:!0,xs:2},n.a.createElement(E.a,{variant:"subtitle1"},"BGG Rank ",c)),n.a.createElement(h.a,{item:!0,xs:2},n.a.createElement(E.a,{variant:"subtitle1"},m&&"\u20ac"+m.price," ",d&&"- \u20ac"+d.price)))))},Yt=function(e){return fetch("".concat("https://boardgamegeek.com/xmlapi","/geeklist/").concat(e)).then(S).then(function(e){return e.text()}).then(function(e){var t=(new wt.a).parseFromString(e);return T(t)})},Xt=function(e){var t=Object(r.useState)([]),a=Object(b.a)(t,2),n=a[0],c=a[1];return Object(r.useEffect)(function(){var t,a;(t=e,a=2,Object(St.a)(Object(ie.a)(ce.a.mark(function e(){return ce.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Yt(t));case 1:case"end":return e.stop()}},e)})),{onFailedAttempt:x,retries:a})).then(function(e){c(e)})},[e]),n},Qt=function(){var e=vt(),t=Xt(e),a=Object(d.c)(function(e){return e.pricesReducer}).spinner,r=Me(function(e){return e.filter(function(e){return t.includes(e.boardgame_id)})}),c=r.stock_filtered,i=r.store_filtered,o=Ue(i);return n.a.createElement(Fe,{child_data:o,stock_filtered:c,store_filtered:i,page_size:500,page_name:"/geeklist/"+e,component:function(e){return a?n.a.createElement(Ot,null):e.map(function(e,t){return n.a.createElement(h.a,{key:e.id,item:!0,xs:12},n.a.createElement(Jt,Object.assign({},e,{alternate:t%2})))})}})},Zt=function(){var e=Object(d.c)(function(e){return e.pricesReducer}).cart_results,t=Me(function(){return e}),a=t.store_filtered,r=t.stock_filtered;return n.a.createElement(Fe,{child_data:a,stock_filtered:r,store_filtered:a,page_name:"/compare",component:function(e){return e.map(function(e){return n.a.createElement(h.a,{key:e.id,item:!0,xs:12,md:6,lg:4},n.a.createElement(nt,{boardgame:e}))})}})},$t=a(113),ea=a(187),ta=Object($t.a)("prices",Object(ie.a)(ce.a.mark(function e(){var t,a,r,n;return ce.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(w+"/rest/v1/prices.json.gz").then(function(e){return e.arrayBuffer()});case 2:return t=e.sent,a=new Uint8Array(t),r=ea.a(a),n=ea.b(r),e.abrupt("return",JSON.parse(n||[]));case 7:case"end":return e.stop()}},e)}))),aa=Object($t.a)("stores",Object(ie.a)(ce.a.mark(function e(){return ce.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(w+"/rest/v1/stores.json").then(function(e){return e.json()});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}))),ra=Object($t.a)("date",Object(ie.a)(ce.a.mark(function e(){var t,a;return ce.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=localStorage.getItem("date"),e.next=3,fetch(w+"/rest/v1/date.json").then(function(e){return e.json()});case 3:return a=e.sent,t!==a.date&&(console.log("updated!",t,a.date),localStorage.setItem("date",a.date),localStorage.setItem("pull","true")),e.abrupt("return",a);case 6:case"end":return e.stop()}},e)}))),na=function(){var e=Object(d.b)(),t=Object(L.g)("store",Object(L.h)(L.c,[-1])),a=Object(b.a)(t,1)[0],c=Object(L.g)("bgg_id",Object(L.h)(L.c,[])),i=Object(b.a)(c,1)[0],o=Object(L.g)("stock",Object(L.h)(L.b,0)),s=Object(b.a)(o,1)[0],l=Object(L.g)("bgg_username",L.e),m=Object(b.a)(l,1)[0],f=Object(L.g)("stores_view",Object(L.h)(L.a,!1)),p=Object(b.a)(f,1)[0];return Object(r.useEffect)(function(){e(ta()),e(aa()),e(ra())},[]),Object(r.useEffect)(function(){e({type:"SET_STORE",store:a})},[a]),Object(r.useEffect)(function(){e({type:"SET_STOCK",stock:s})},[s]),Object(r.useEffect)(function(){e({type:"SET_WISHLIST_USERNAME",payload:m})},[m]),Object(r.useEffect)(function(){e({type:"SET_CART",payload:i})},[i]),Object(r.useEffect)(function(){e({type:"SET_WISHLIST_VIEW",payload:p})},[p]),n.a.createElement(u.c,null,n.a.createElement(u.a,{path:"/",exact:!0},n.a.createElement(ze,null)),n.a.createElement(u.a,{path:"/cart",exact:!0},n.a.createElement(Bt,null)),n.a.createElement(u.a,{path:"/search",exact:!0},n.a.createElement(Kt,null)),n.a.createElement(u.a,{path:"/wishlist",exact:!0},n.a.createElement(zt,null)),n.a.createElement(u.a,{path:"/geeklist/:geeklist_id"},n.a.createElement(Qt,null)),n.a.createElement(u.a,{path:"/item/:boardgame_id"},n.a.createElement(jt,null)),n.a.createElement(u.a,{path:"/compare"},n.a.createElement(Zt,null)))},ca=a(130),ia=a(263),oa=Object(m.combineReducers)({pricesReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT":return{store:[-1],stock:0,order:0,cart_results:[],search_term:"",search_results:[],search_enabled:!1,wishlist_term:"",wishlist_priority:-1,wishlist_stores_view:!1,wishlist:[],prices:[],history:[],stores:[],spinner:!0,date:new Date,user:{isAuthenticated:!1,details:{},saved:!0}};case"prices/fulfilled":return Object(p.a)({},e,{spinner:!1,prices:t.payload});case"date/fulfilled":return Object(p.a)({},e,{date:new Date(t.payload.date)});case"stores/fulfilled":return Object(p.a)({},e,{stores:t.payload});case"SET_STOCK":return Object(p.a)({},e,{stock:t.stock});case"SET_STORE":return Object(p.a)({},e,{store:t.store});case"ADD_TO_CART":return Object(p.a)({},e,{cart_results:[].concat(Object(f.a)(e.cart_results.filter(function(e){return e!==t.cart})),[t.cart])});case"SET_CART":return Object(p.a)({},e,{cart_results:t.payload});case"SET_SEARCH_TERM":return Object(p.a)({},e,{search_term:t.payload,search_enabled:!1});case"EXECUTE_SEARCH":return Object(p.a)({},e,{search_enabled:!0});case"SET_WISHLIST":return Object(p.a)({},e,{wishlist:t.payload});case"SET_WISHLIST_USERNAME":return Object(p.a)({},e,{wishlist_term:t.payload});case"SET_WISHLIST_VIEW":return Object(p.a)({},e,{wishlist_stores_view:t.payload});case"SET_PRIORITY":return Object(p.a)({},e,{wishlist_priority:t.payload});case"TOGGLE_SPINNER":return Object(p.a)({},e,{spinner:!e.spinner});case"SET_USER":return Object(p.a)({},e,{user:Object(p.a)({},t.payload,{saved:!0})});default:return e}}}),ua=Object(ia.composeWithDevTools)(Object(m.applyMiddleware)(ca.a)),sa=Object(m.createStore)(oa,ua);sa.dispatch({type:"INIT"});var la={transformSearchString:L.f},ma=Object(s.a)({palette:{primary:{main:"#5e81ac"},secondary:{main:"#bf616a"},text:{primary:"#2e3440"}},overrides:{MuiInputLabel:{root:{backgroundColor:"#ffffff",paddingLeft:"4px",paddingRight:"4px"}}}});i.a.render(n.a.createElement(l.a,{theme:ma},n.a.createElement(o.a,null,n.a.createElement(d.a,{store:sa},n.a.createElement(u.a,{path:"/"},n.a.createElement(ye.a,{domain:"dev-11hy0hqn.us.auth0.com",clientId:"gEd77V5i5uBswawxfycFKL1eEv8BlhdE",redirectUri:window.location.origin},n.a.createElement(L.d,{ReactRouterRoute:u.a,stringifyOptions:la},n.a.createElement(na,null))))))),document.getElementById("root"))}},[[282,1,2]]]);
//# sourceMappingURL=main.4dffafdb.chunk.js.map